<div class="reviews-container">
  <div class="reviews-header">
    <h2>Reseñas</h2>
    <button class="add-review-btn" (click)="toggleReviewForm()" *ngIf="currentUser">
      {{ showReviewForm ? 'Cancelar' : 'Crear Reseña' }}
    </button>
  </div>

  <!-- Formulario para crear reseña -->
  <div class="review-form" *ngIf="showReviewForm && currentUser">
    <form (ngSubmit)="submitReview()" #reviewForm="ngForm">
      <div class="form-group">
        <label for="content">Reseña:</label>
        <textarea
          id="content"
          [(ngModel)]="newReview.content"
          name="content"
          required></textarea>
      </div>
      <button
      type="submit"
      [disabled]="!reviewForm.valid"
      class="edit-btn">
      Publicar Reseña
    </button>
        </form>
  </div>

  <div *ngIf="loading" class="loading">
    Cargando reseñas...
  </div>

  <div *ngIf="error" class="error">
    {{ error }}
  </div>

  <div *ngIf="!loading && !error && getAllReviews().length === 0" class="no-reviews">
    No hay reseñas disponibles para esta película.
  </div>

  <div *ngIf="getAllReviews().length > 0" class="review-slider">
    <button
      class="nav-button prev"
      (click)="previousReview()"
      [disabled]="currentIndex === 0">
      ←
    </button>

    <div class="review-card">
      <div class="review-header">
        <h3>{{ getCurrentReview().author || getCurrentReview().username }}</h3>
        <span class="review-date">{{ getCurrentReview().created_at | date }}</span>
      </div>
      <p class="review-content">{{ getCurrentReview().content }}</p>
      <div class="review-counter">
        {{ currentIndex + 1 }} / {{ getAllReviews().length }}
      </div>
      <!-- Agregar dentro de review-card si quieres permitir editar/eliminar -->
      <div class="review-actions" class="button-container" *ngIf="canEditReview(getCurrentReview())">
        <button class="edit-btn" (click)="editReview(getCurrentReview())">Editar </button>
        <button class="delete-btn" (click)="deleteReview(getCurrentReview().id)"> Eliminar</button>
      </div>

    </div>

    <button
      class="nav-button next"
      (click)="nextReview()"
      [disabled]="currentIndex === getAllReviews().length - 1">
      →
    </button>
  </div>
</div>
